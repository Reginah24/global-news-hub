global
    daemon
    maxconn 4096
    log stdout local0 info

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    option httplog
    log global

# Frontend configuration
frontend web_frontend
    bind *:80
    default_backend webapps

# Backend configuration for round-robin load balancing
backend webapps
    balance roundrobin
    option httpchk GET /
    http-check expect status 200
    
    # For deployment on Web01 and Web02
    server web01 172.20.0.11:8080 check
    server web02 172.20.0.12:8080 check
    
    # For local testing with docker-compose
    # server app1 app:8080 check

# HAProxy Statistics
listen stats
    bind *:8404
    stats enable
    stats uri /stats
    stats refresh 30s
    stats show-node
